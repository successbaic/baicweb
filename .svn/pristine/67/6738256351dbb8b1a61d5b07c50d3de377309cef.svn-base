package com.macrosoft.icms.gqdj;
import java.sql.*;
import java.util.*;
import com.macrosoft.icms.dbc.*;
import com.macrosoft.icms.*;
import com.macrosoft.icms.system.*;
public class GQDJ_YWSB_SQ
{
	String APPROPIN;
	String APPRPER;
	String APPRDATE;
	String REJREA;
	String REJDATE;
	String ENTNAME;
	String REGORG;
	int SIGN;
	String REGNO;
	String LEREP;
	String GROUPID;
	String OPENO;
	String MORREGNO;
	String PRIPID;
	String OPETYPE;
	String APPFORM;
	String LINKMAN;
	String CERTYPE;
	String CERNO;
	String TEL;
	String MOBTEL;
	String APPDATE;
	String NOTNO;
	String ACCOPIN;
	String ACCPER;
	String ACCDATE;
	String UNACCREA;
	String UNACCDATE;
	String APPNO;

	int ENTCLASS;


	public void setNOTNONoConvert( String NOTNO)
	{
		this.NOTNO=doPreProcess2(NOTNO);
	}

	public void setAPPNONoConvert( String APPNO)
	{
		this.APPNO=doPreProcess2(APPNO);
	}

	public void setENTNAMEDirect( String ENTNAME)
	{
		this.ENTNAME=doPreProcess2(ENTNAME);
	}

	public void setLEREPDirect( String LEREP)
	{
		this.LEREP=doPreProcess2(LEREP);
	}

	public int getENTCLASS()
	{
		return ENTCLASS;
	}

	public void setENTCLASS( int ENTCLASS)
	{
		this.ENTCLASS=ENTCLASS ;
	}


	public String getAPPROPIN()
	{
		return doPreProcess(APPROPIN);
	}

	public void setAPPROPIN( String APPROPIN)
	{
		this.APPROPIN=doPreProcess2(convertCode(APPROPIN));
	}

	public String getAPPRPER()
	{
		return doPreProcess(APPRPER);
	}

	public void setAPPRPER( String APPRPER)
	{
		this.APPRPER=doPreProcess2(convertCode(APPRPER));
	}

	public String getAPPRDATE()
	{
		return doPreProcess(APPRDATE);
	}

	public void setAPPRDATE( String APPRDATE)
	{
		this.APPRDATE=doPreProcess2(convertCode(APPRDATE));
	}

	public String getREJREA()
	{
		return doPreProcess(REJREA);
	}

	public void setREJREA( String REJREA)
	{
		this.REJREA=doPreProcess2(convertCode(REJREA));
	}

	public String getREJDATE()
	{
		return doPreProcess(REJDATE);
	}

	public void setREJDATE( String REJDATE)
	{
		this.REJDATE=doPreProcess2(convertCode(REJDATE));
	}

	public String getENTNAME()
	{
		return doPreProcess(ENTNAME);
	}

	public void setENTNAME( String ENTNAME)
	{
		this.ENTNAME=doPreProcess2(convertCode(ENTNAME));
	}

	public String getREGORG()
	{
		return doPreProcess(REGORG);
	}

	public void setREGORG( String REGORG)
	{
		this.REGORG=doPreProcess2(convertCode(REGORG));
	}

	public int getSIGN()
	{
		return SIGN;
	}

	public void setSIGN( int SIGN)
	{
		this.SIGN=SIGN ;
	}

	public String getREGNO()
	{
		return doPreProcess(REGNO);
	}

	public void setREGNO( String REGNO)
	{
		this.REGNO=doPreProcess2(convertCode(REGNO));
	}

	public String getLEREP()
	{
		return doPreProcess(LEREP);
	}

	public void setLEREP( String LEREP)
	{
		this.LEREP=doPreProcess2(convertCode(LEREP));
	}

	public String getGROUPID()
	{
		return doPreProcess(GROUPID);
	}

	public void setGROUPID( String GROUPID)
	{
		this.GROUPID=doPreProcess2(convertCode(GROUPID));
	}

	public String getOPENO()
	{
		return doPreProcess(OPENO);
	}

	public void setOPENO( String OPENO)
	{
		this.OPENO=doPreProcess2(convertCode(OPENO));
	}

	public String getMORREGNO()
	{
		return doPreProcess(MORREGNO);
	}

	public void setMORREGNO( String MORREGNO)
	{
		this.MORREGNO=doPreProcess2(convertCode(MORREGNO));
	}

	public String getPRIPID()
	{
		return doPreProcess(PRIPID);
	}

	public void setPRIPID( String PRIPID)
	{
		this.PRIPID=doPreProcess2(convertCode(PRIPID));
	}

	public String getOPETYPE()
	{
		return doPreProcess(OPETYPE);
	}

	public void setOPETYPE( String OPETYPE)
	{
		this.OPETYPE=doPreProcess2(convertCode(OPETYPE));
	}

	public String getAPPFORM()
	{
		return doPreProcess(APPFORM);
	}

	public void setAPPFORM( String APPFORM)
	{
		this.APPFORM=doPreProcess2(convertCode(APPFORM));
	}

	public String getLINKMAN()
	{
		return doPreProcess(LINKMAN);
	}

	public void setLINKMAN( String LINKMAN)
	{
		this.LINKMAN=doPreProcess2(convertCode(LINKMAN));
	}

	public String getCERTYPE()
	{
		return doPreProcess(CERTYPE);
	}

	public void setCERTYPE( String CERTYPE)
	{
		this.CERTYPE=doPreProcess2(convertCode(CERTYPE));
	}

	public String getCERNO()
	{
		return doPreProcess(CERNO);
	}

	public void setCERNO( String CERNO)
	{
		this.CERNO=doPreProcess2(convertCode(CERNO));
	}

	public String getTEL()
	{
		return doPreProcess(TEL);
	}

	public void setTEL( String TEL)
	{
		this.TEL=doPreProcess2(convertCode(TEL));
	}

	public String getMOBTEL()
	{
		return doPreProcess(MOBTEL);
	}

	public void setMOBTEL( String MOBTEL)
	{
		this.MOBTEL=doPreProcess2(convertCode(MOBTEL));
	}

	public String getAPPDATE()
	{
		return doPreProcess(APPDATE);
	}

	public void setAPPDATE( String APPDATE)
	{
		this.APPDATE=doPreProcess2(convertCode(APPDATE));
	}

	public String getNOTNO()
	{
		return doPreProcess(NOTNO);
	}

	public void setNOTNO( String NOTNO)
	{
		this.NOTNO=doPreProcess2(convertCode(NOTNO));
	}

	public String getACCOPIN()
	{
		return doPreProcess(ACCOPIN);
	}

	public void setACCOPIN( String ACCOPIN)
	{
		this.ACCOPIN=doPreProcess2(convertCode(ACCOPIN));
	}

	public String getACCPER()
	{
		return doPreProcess(ACCPER);
	}

	public void setACCPER( String ACCPER)
	{
		this.ACCPER=doPreProcess2(convertCode(ACCPER));
	}

	public String getACCDATE()
	{
		return doPreProcess(ACCDATE);
	}

	public void setACCDATE( String ACCDATE)
	{
		this.ACCDATE=doPreProcess2(convertCode(ACCDATE));
	}

	public String getUNACCREA()
	{
		return doPreProcess(UNACCREA);
	}

	public void setUNACCREA( String UNACCREA)
	{
		this.UNACCREA=doPreProcess2(convertCode(UNACCREA));
	}

	public String getUNACCDATE()
	{
		return doPreProcess(UNACCDATE);
	}

	public void setUNACCDATE( String UNACCDATE)
	{
		this.UNACCDATE=doPreProcess2(convertCode(UNACCDATE));
	}

	public String getAPPNO()
	{
		return doPreProcess(APPNO);
	}

	public void setAPPNO( String APPNO)
	{
		this.APPNO=doPreProcess2(convertCode(APPNO));
	}

	public String convertCode(String strvalue)
	{	return com.macrosoft.icms.system.SysUtility.convertCode( strvalue );	}

	public String doPreProcess( String sValue )
	{	return com.macrosoft.icms.system.SysUtility.doPreProcess( sValue );	}

	public String doPreProcess2( String sValue )
	{	return com.macrosoft.icms.system.SysUtility.doPreProcess2( sValue );	}

	public String doPreProcess3( String sValue )
	{	return com.macrosoft.icms.system.SysUtility.doPreProcess3( sValue );	}

	public void doSelect() throws SQLException
	{
		DbConnection dbc=new DbConnection();
		ResultSet rsSelect;
		String sqlSelect="SELECT * FROM GQDJ_YWSB_SQ"+" WHERE OPENO='"+doPreProcess(OPENO)+"'";
		rsSelect=dbc.executeQuery(sqlSelect);
		if(rsSelect.next())
		{
			doSetData( rsSelect );
		}
		dbc.close();
	}

	public void doSetData( ResultSet rsSelect ) throws SQLException
	{
	APPROPIN=rsSelect.getString("APPROPIN");
	APPRPER=rsSelect.getString("APPRPER");
	APPRDATE=String.valueOf(rsSelect.getDate("APPRDATE"));
	REJREA=rsSelect.getString("REJREA");
	REJDATE=String.valueOf(rsSelect.getDate("REJDATE"));
	ENTNAME=rsSelect.getString("ENTNAME");
	REGORG=rsSelect.getString("REGORG");
	SIGN=rsSelect.getInt("SIGN");
	REGNO=rsSelect.getString("REGNO");
	LEREP=rsSelect.getString("LEREP");
	GROUPID=rsSelect.getString("GROUPID");
	OPENO=rsSelect.getString("OPENO");
	MORREGNO=rsSelect.getString("MORREGNO");
	PRIPID=rsSelect.getString("PRIPID");
	OPETYPE=rsSelect.getString("OPETYPE");
	APPFORM=rsSelect.getString("APPFORM");
	LINKMAN=rsSelect.getString("LINKMAN");
	CERTYPE=rsSelect.getString("CERTYPE");
	CERNO=rsSelect.getString("CERNO");
	TEL=rsSelect.getString("TEL");
	MOBTEL=rsSelect.getString("MOBTEL");
	APPDATE=String.valueOf(rsSelect.getDate("APPDATE"));
	NOTNO=rsSelect.getString("NOTNO");
	ACCOPIN=rsSelect.getString("ACCOPIN");
	ACCPER=rsSelect.getString("ACCPER");
	ACCDATE=String.valueOf(rsSelect.getDate("ACCDATE"));
	UNACCREA=rsSelect.getString("UNACCREA");
	UNACCDATE=String.valueOf(rsSelect.getDate("UNACCDATE"));
	APPNO=rsSelect.getString("APPNO");

	ENTCLASS=rsSelect.getInt("ENTCLASS");
	}

	public boolean doAdd() throws SQLException
	{
		DbConnection dbc=new DbConnection();
		ResultSet rsCount;
		int nRowCount;
		String sqlAdd="INSERT INTO GQDJ_YWSB_SQ(ENTCLASS,APPROPIN,APPRPER,APPRDATE,REJREA,REJDATE,ENTNAME,REGORG,SIGN,REGNO,LEREP,GROUPID,OPENO,MORREGNO,PRIPID,OPETYPE,APPFORM,LINKMAN,CERTYPE,CERNO,TEL,MOBTEL,APPDATE,NOTNO,ACCOPIN,ACCPER,ACCDATE,UNACCREA,UNACCDATE,APPNO) VALUES("+ENTCLASS+","+ doPreProcess3(APPROPIN)+","+ doPreProcess3(APPRPER)+",to_date("+doPreProcess3(APPRDATE)+",'yyyy-mm-dd'),"+ doPreProcess3(REJREA)+",to_date("+doPreProcess3(REJDATE)+",'yyyy-mm-dd'),"+ doPreProcess3(ENTNAME)+","+ doPreProcess3(REGORG)+","+SIGN+","+ doPreProcess3(REGNO)+","+ doPreProcess3(LEREP)+","+ doPreProcess3(GROUPID)+","+ doPreProcess3(OPENO)+","+ doPreProcess3(MORREGNO)+","+ doPreProcess3(PRIPID)+","+ doPreProcess3(OPETYPE)+","+ doPreProcess3(APPFORM)+","+ doPreProcess3(LINKMAN)+","+ doPreProcess3(CERTYPE)+","+ doPreProcess3(CERNO)+","+ doPreProcess3(TEL)+","+ doPreProcess3(MOBTEL)+",to_date("+doPreProcess3(APPDATE)+",'yyyy-mm-dd'),"+ doPreProcess3(NOTNO)+","+ doPreProcess3(ACCOPIN)+","+ doPreProcess3(ACCPER)+",to_date("+doPreProcess3(ACCDATE)+",'yyyy-mm-dd'),"+ doPreProcess3(UNACCREA)+",to_date("+doPreProcess3(UNACCDATE)+",'yyyy-mm-dd'),"+ doPreProcess3(APPNO)+")";
		{							
			nRowCount=dbc.executeUpdate( sqlAdd );
			dbc.close();
			if (nRowCount>0)	//插入成功
				return true;
			else
				return false;
		}
	}

	public boolean doCount() throws SQLException
	{
		DbConnection dbc=new DbConnection();
		ResultSet rsCount;
		int nRowCount;
		String sqlCount="SELECT COUNT(*) FROM GQDJ_YWSB_SQ"+" WHERE OPENO='"+doPreProcess(OPENO)+"'";
		rsCount=dbc.executeQuery( sqlCount );
		rsCount.next();
		nRowCount=rsCount.getInt( 1 );

		dbc.close();
		if (nRowCount>0)
		{
			return true;
		}
		else
			return false;
	}

	public boolean doModify() throws SQLException
	{
		int nRowCount=0;
		if(!doCount())
		{
			if (doAdd())	 
 				return true;
 			else
				return false;
 		}
		else
		{
			DbConnection dbc=new DbConnection();
			String sqlModify="UPDATE GQDJ_YWSB_SQ SET ENTCLASS="+ENTCLASS+",APPROPIN="+ doPreProcess3(APPROPIN)+",APPRPER="+ doPreProcess3(APPRPER)+",APPRDATE=to_date("+doPreProcess3(APPRDATE)+",'yyyy-mm-dd'),REJREA="+ doPreProcess3(REJREA)+",REJDATE=to_date("+doPreProcess3(REJDATE)+",'yyyy-mm-dd'),ENTNAME="+ doPreProcess3(ENTNAME)+",REGORG="+ doPreProcess3(REGORG)+",SIGN="+SIGN+",REGNO="+ doPreProcess3(REGNO)+",LEREP="+ doPreProcess3(LEREP)+",GROUPID="+ doPreProcess3(GROUPID)+",OPENO="+ doPreProcess3(OPENO)+",MORREGNO="+ doPreProcess3(MORREGNO)+",PRIPID="+ doPreProcess3(PRIPID)+",OPETYPE="+ doPreProcess3(OPETYPE)+",APPFORM="+ doPreProcess3(APPFORM)+",LINKMAN="+ doPreProcess3(LINKMAN)+",CERTYPE="+ doPreProcess3(CERTYPE)+",CERNO="+ doPreProcess3(CERNO)+",TEL="+ doPreProcess3(TEL)+",MOBTEL="+ doPreProcess3(MOBTEL)+",APPDATE=to_date("+doPreProcess3(APPDATE)+",'yyyy-mm-dd'),NOTNO="+ doPreProcess3(NOTNO)+",ACCOPIN="+ doPreProcess3(ACCOPIN)+",ACCPER="+ doPreProcess3(ACCPER)+",ACCDATE=to_date("+doPreProcess3(ACCDATE)+",'yyyy-mm-dd'),UNACCREA="+ doPreProcess3(UNACCREA)+",UNACCDATE=to_date("+doPreProcess3(UNACCDATE)+",'yyyy-mm-dd'),APPNO="+ doPreProcess3(APPNO)+""+" WHERE OPENO='"+doPreProcess(OPENO)+"'";
			nRowCount=dbc.executeUpdate( sqlModify );
			dbc.close();
			if (nRowCount>0)	//修改成功
			{
				return true;
			}
			else
				return false;
		}
	}

	public boolean doDelete() throws SQLException
	{
		DbConnection dbc=new DbConnection();
		String sqlDelete="DELETE FROM GQDJ_YWSB_SQ"+" WHERE OPENO='"+doPreProcess(OPENO)+"'";
		int nRowCount=dbc.executeUpdate( sqlDelete );
		dbc.close();
		if (nRowCount>0)
		{
			return true;
		}
		else
			return false;
	}

	public int getListCount(String sqlWhere ) throws SQLException
	{
		DbConnection dbc=new DbConnection();
		String sqlCount="SELECT COUNT(*) FROM GQDJ_YWSB_SQ";
		if (sqlWhere!=null&&sqlWhere.trim().compareTo("")!=0){
			if (sqlWhere.trim().toUpperCase().startsWith("WHERE")){
				sqlCount+=sqlWhere;}
			else {
				sqlCount+=" WHERE "+sqlWhere;}
		}
		ResultSet rsCount=dbc.executeQuery( sqlCount );
		rsCount.next();
		int nRowCount=rsCount.getInt( 1 );
		dbc.close();
		return nRowCount;

	}

	public ArrayList getList( String sqlWhere ) throws SQLException
	{
		DbConnection dbc=new DbConnection();
		ArrayList al= new ArrayList();
		String sqlList="SELECT * FROM GQDJ_YWSB_SQ";
		if (sqlWhere!=null&&sqlWhere.trim().compareTo("")!=0){
			if (sqlWhere.trim().toUpperCase().startsWith("WHERE")){
				sqlList+=sqlWhere;}
			else {
				sqlList+=" WHERE "+sqlWhere;}
		}
		ResultSet rsList=dbc.executeQuery( sqlList );
		while(rsList.next()) {
			GQDJ_YWSB_SQ bTable=new GQDJ_YWSB_SQ();
			bTable.doSetData( rsList );
			al.add(bTable);
		}
		rsList.close();dbc.close();
		return al;

	}

	public Iterator getItList( String sqlWhere,String startRow ) throws SQLException
	{
		if (SysUtility.isNumeric(startRow))		
			return getList(sqlWhere,Integer.parseInt(startRow)).iterator();
		else		
			return getList(sqlWhere,0).iterator();
	}
	public ArrayList getList( String sqlWhere,String startRow ) throws SQLException
	{
		if (SysUtility.isNumeric(startRow))		
			return getList( sqlWhere,Integer.parseInt(startRow),10);
		else		
			return getList( sqlWhere,0,10);
	}
	public ArrayList getList( String sqlWhere,String startRow,int PageSize ) throws SQLException
	{
		if (SysUtility.isNumeric(startRow))		
			return getList( sqlWhere,Integer.parseInt(startRow),PageSize);
		else		
			return getList( sqlWhere,0,PageSize);
	}
	public ArrayList getList( String sqlWhere,int startRow ) throws SQLException
	{
			return getList( sqlWhere,startRow,10);
	}
	////////reload function getlist
	public ArrayList getList( String sqlWhere,int startRow,int PageSize) throws SQLException
	{
		DbConnection dbc=new DbConnection();
		ArrayList al= new ArrayList();
		String sqlList="SELECT * FROM GQDJ_YWSB_SQ";
		if (sqlWhere!=null&&sqlWhere.trim().compareTo("")!=0){
			if (sqlWhere.trim().toUpperCase().startsWith("WHERE")){
				sqlList+=sqlWhere;}
			else {
				sqlList+=" WHERE "+sqlWhere;}
		}
		sqlList+=" AND ROWNUM<="+(startRow+PageSize);//start+pagesize 
		ResultSet rsList=dbc.executeQuery( sqlList);
		//过掉所有已经显示的列
		int	nDispRows=0;
		do
		{
			nDispRows++;
			if (nDispRows>startRow)	break;
		}
		while (rsList.next());
		while(rsList.next()) {
			GQDJ_YWSB_SQ bTable=new GQDJ_YWSB_SQ();
			bTable.doSetData( rsList );
			al.add(bTable);
		}
		rsList.close();dbc.close();
		return al;

	}

	public ArrayList getData() throws SQLException
	{
		DbConnection dbc=new DbConnection();
		String sqlArr="SELECT * FROM GQDJ_YWSB_SQ"+" WHERE OPENO='"+doPreProcess(OPENO)+"'";
		ResultSet rsArr=dbc.executeQuery(sqlArr);
		ArrayList al= new ArrayList();
		String[] ay = null;
		if (rsArr.next()){	
			doSetData( rsArr );
			ResultSetMetaData rsmd = rsArr.getMetaData();
			for (int k=1;k<=rsmd.getColumnCount(); k++)	{
				ay = new String[2];
				ay[0]=rsmd.getColumnName(k);
				if (rsmd.getColumnTypeName(k).equalsIgnoreCase("DATETIME")||rsmd.getColumnTypeName(k).equalsIgnoreCase("DATE"))
					ay[1]=String.valueOf(rsArr.getDate(ay[0]));
				else
					ay[1]=String.valueOf(rsArr.getObject(ay[0]));
				if (!ay[1].trim().equals("null")&&!ay[1].trim().equals(""))
					{ay[1]=SysUtility.pre(ay[1]); al.add(ay);}
			}
		}
		dbc.close();
		return al;

	}
}
