package com.macrosoft.icms.qydj;
import java.sql.*;
import java.util.*;
import com.macrosoft.icms.dbc.*;
import com.macrosoft.icms.*;
import com.macrosoft.icms.system.*;
public class QYDJ_ZXXX_SQ
{
	String OPENO;
	String PRIPID;
	String CANDOCNO;
	String CANREA;
	String EXTCLEBRSIGN;
	String CANCELBRSIGN;
	String DECLECOMP;
	String DECLEBRSIGN;
	String AFFWRITNO;
	String PUBNEWSNAME;
	String PUBDATE;
	String CANDATE;
	String SANAUTH;
	String SANDOCNO;
	String SANDATE;
	int BLICREVORINUM;
	String BLICREVORINO;
	int BLICREVDUPCONUM;
	String BLICREVDUPCONO;
	int CAREVNUM;
	String CAREVST;
	String BRANCHCANCON;
	String DECLECON;
	String REMARK;
	String CLEANTAX;
	String CANCELLATIONCERTIFICATE;
	String CUSTOMSETTLEMENT;
	String CLEANBONDUNIT;
	
	public String getOPENO()
	{
		return doPreProcess(OPENO);
	}

	public void setOPENO( String OPENO)
	{
		this.OPENO=doPreProcess2(convertCode(OPENO));
	}

	public String getPRIPID()
	{
		return doPreProcess(PRIPID);
	}

	public void setPRIPID( String PRIPID)
	{
		this.PRIPID=doPreProcess2(convertCode(PRIPID));
	}

	public String getCANDOCNO()
	{
		return doPreProcess(CANDOCNO);
	}

	public void setCANDOCNO( String CANDOCNO)
	{
		this.CANDOCNO=doPreProcess2(convertCode(CANDOCNO));
	}

	public String getCANREA()
	{
		return doPreProcess(CANREA);
	}

	public void setCANREA( String CANREA)
	{
		this.CANREA=doPreProcess2(convertCode(CANREA));
	}

	public String getEXTCLEBRSIGN()
	{
		return doPreProcess(EXTCLEBRSIGN);
	}

	public void setEXTCLEBRSIGN( String EXTCLEBRSIGN)
	{
		this.EXTCLEBRSIGN=doPreProcess2(convertCode(EXTCLEBRSIGN));
	}

	public String getCANCELBRSIGN()
	{
		return doPreProcess(CANCELBRSIGN);
	}

	public void setCANCELBRSIGN( String CANCELBRSIGN)
	{
		this.CANCELBRSIGN=doPreProcess2(convertCode(CANCELBRSIGN));
	}

	public String getDECLECOMP()
	{
		return doPreProcess(DECLECOMP);
	}

	public void setDECLECOMP( String DECLECOMP)
	{
		this.DECLECOMP=doPreProcess2(convertCode(DECLECOMP));
	}

	public String getDECLEBRSIGN()
	{
		return doPreProcess(DECLEBRSIGN);
	}

	public void setDECLEBRSIGN( String DECLEBRSIGN)
	{
		this.DECLEBRSIGN=doPreProcess2(convertCode(DECLEBRSIGN));
	}

	public String getAFFWRITNO()
	{
		return doPreProcess(AFFWRITNO);
	}

	public void setAFFWRITNO( String AFFWRITNO)
	{
		this.AFFWRITNO=doPreProcess2(convertCode(AFFWRITNO));
	}

	public String getPUBNEWSNAME()
	{
		return doPreProcess(PUBNEWSNAME);
	}

	public void setPUBNEWSNAME( String PUBNEWSNAME)
	{
		this.PUBNEWSNAME=doPreProcess2(convertCode(PUBNEWSNAME));
	}

	public String getPUBDATE()
	{
		return doPreProcess(PUBDATE);
	}

	public void setPUBDATE( String PUBDATE)
	{
		this.PUBDATE=doPreProcess2(convertCode(PUBDATE));
	}

	public String getCANDATE()
	{
		return doPreProcess(CANDATE);
	}

	public void setCANDATE( String CANDATE)
	{
		this.CANDATE=doPreProcess2(convertCode(CANDATE));
	}

	public String getSANAUTH()
	{
		return doPreProcess(SANAUTH);
	}

	public void setSANAUTH( String SANAUTH)
	{
		this.SANAUTH=doPreProcess2(convertCode(SANAUTH));
	}

	public String getSANDOCNO()
	{
		return doPreProcess(SANDOCNO);
	}

	public void setSANDOCNO( String SANDOCNO)
	{
		this.SANDOCNO=doPreProcess2(convertCode(SANDOCNO));
	}

	public String getSANDATE()
	{
		return doPreProcess(SANDATE);
	}

	public void setSANDATE( String SANDATE)
	{
		this.SANDATE=doPreProcess2(convertCode(SANDATE));
	}

	public int getBLICREVORINUM()
	{
		return BLICREVORINUM;
	}

	public void setBLICREVORINUM( int BLICREVORINUM)
	{
		this.BLICREVORINUM=BLICREVORINUM ;
	}

	public String getBLICREVORINO()
	{
		return doPreProcess(BLICREVORINO);
	}

	public void setBLICREVORINO( String BLICREVORINO)
	{
		this.BLICREVORINO=doPreProcess2(convertCode(BLICREVORINO));
	}

	public int getBLICREVDUPCONUM()
	{
		return BLICREVDUPCONUM;
	}

	public void setBLICREVDUPCONUM( int BLICREVDUPCONUM)
	{
		this.BLICREVDUPCONUM=BLICREVDUPCONUM ;
	}

	public String getBLICREVDUPCONO()
	{
		return doPreProcess(BLICREVDUPCONO);
	}

	public void setBLICREVDUPCONO( String BLICREVDUPCONO)
	{
		this.BLICREVDUPCONO=doPreProcess2(convertCode(BLICREVDUPCONO));
	}

	public int getCAREVNUM()
	{
		return CAREVNUM;
	}

	public void setCAREVNUM( int CAREVNUM)
	{
		this.CAREVNUM=CAREVNUM ;
	}

	public String getCAREVST()
	{
		return doPreProcess(CAREVST);
	}

	public void setCAREVST( String CAREVST)
	{
		this.CAREVST=doPreProcess2(convertCode(CAREVST));
	}

	public String getBRANCHCANCON()
	{
		return doPreProcess(BRANCHCANCON);
	}

	public void setBRANCHCANCON( String BRANCHCANCON)
	{
		this.BRANCHCANCON=doPreProcess2(convertCode(BRANCHCANCON));
	}

	public String getDECLECON()
	{
		return doPreProcess(DECLECON);
	}

	public void setDECLECON( String DECLECON)
	{
		this.DECLECON=doPreProcess2(convertCode(DECLECON));
	}

	public String getREMARK()
	{
		return doPreProcess(REMARK);
	}

	public void setREMARK( String REMARK)
	{
		this.REMARK=doPreProcess2(convertCode(REMARK));
	}

	public String getCLEANTAX()
	{
		return doPreProcess(CLEANTAX);
	}

	public void setCLEANTAX( String CLEANTAX)
	{
		this.CLEANTAX=doPreProcess2(convertCode(CLEANTAX));
	}
	
	public String getCANCELLATIONCERTIFICATE()
	{
		return doPreProcess(CANCELLATIONCERTIFICATE);
	}

	public void setCANCELLATIONCERTIFICATE( String CANCELLATIONCERTIFICATE)
	{
		this.CANCELLATIONCERTIFICATE=doPreProcess2(convertCode(CANCELLATIONCERTIFICATE));
	}
	
	public String getCUSTOMSETTLEMENT()
	{
		return doPreProcess(CUSTOMSETTLEMENT);
	}

	public void setCUSTOMSETTLEMENT( String CUSTOMSETTLEMENT)
	{
		this.CUSTOMSETTLEMENT=doPreProcess2(convertCode(CUSTOMSETTLEMENT));
	}
	
	public String getCLEANBONDUNIT()
	{
		return doPreProcess(CLEANBONDUNIT);
	}

	public void setCLEANBONDUNIT( String CLEANBONDUNIT)
	{
		this.CLEANBONDUNIT=doPreProcess2(convertCode(CLEANBONDUNIT));
	}
	
	public String convertCode(String strvalue)
	{	return com.macrosoft.icms.system.SysUtility.convertCode( strvalue );	}

	public String doPreProcess( String sValue )
	{	return com.macrosoft.icms.system.SysUtility.doPreProcess( sValue );	}

	public String doPreProcess2( String sValue )
	{	return com.macrosoft.icms.system.SysUtility.doPreProcess2( sValue );	}

	public String doPreProcess3( String sValue )
	{	return com.macrosoft.icms.system.SysUtility.doPreProcess3( sValue );	}

	public void doSelect() throws SQLException
	{
		DbConnection dbc=new DbConnection();
		ResultSet rsSelect;
		String sqlSelect="SELECT * FROM QYDJ_ZXXX_SQ"+" WHERE OPENO='"+doPreProcess(OPENO)+"'";
		rsSelect=dbc.executeQuery(sqlSelect);
		if(rsSelect.next())
		{
			doSetData( rsSelect );
		}
		dbc.close();
	}

	public void doSetData( ResultSet rsSelect ) throws SQLException
	{
	OPENO=rsSelect.getString("OPENO");
	PRIPID=rsSelect.getString("PRIPID");
	CANDOCNO=rsSelect.getString("CANDOCNO");
	CANREA=rsSelect.getString("CANREA");
	EXTCLEBRSIGN=rsSelect.getString("EXTCLEBRSIGN");
	CANCELBRSIGN=rsSelect.getString("CANCELBRSIGN");
	DECLECOMP=rsSelect.getString("DECLECOMP");
	DECLEBRSIGN=rsSelect.getString("DECLEBRSIGN");
	AFFWRITNO=rsSelect.getString("AFFWRITNO");
	PUBNEWSNAME=rsSelect.getString("PUBNEWSNAME");
	PUBDATE=String.valueOf(rsSelect.getDate("PUBDATE"));
	CANDATE=String.valueOf(rsSelect.getDate("CANDATE"));
	SANAUTH=rsSelect.getString("SANAUTH");
	SANDOCNO=rsSelect.getString("SANDOCNO");
	SANDATE=String.valueOf(rsSelect.getDate("SANDATE"));
	BLICREVORINUM=rsSelect.getInt("BLICREVORINUM");
	BLICREVORINO=rsSelect.getString("BLICREVORINO");
	BLICREVDUPCONUM=rsSelect.getInt("BLICREVDUPCONUM");
	BLICREVDUPCONO=rsSelect.getString("BLICREVDUPCONO");
	CAREVNUM=rsSelect.getInt("CAREVNUM");
	CAREVST=rsSelect.getString("CAREVST");
	BRANCHCANCON=rsSelect.getString("BRANCHCANCON");
	DECLECON=rsSelect.getString("DECLECON");
	REMARK=rsSelect.getString("REMARK");
	CLEANTAX=rsSelect.getString("CLEANTAX");
	CANCELLATIONCERTIFICATE=rsSelect.getString("CANCELLATIONCERTIFICATE");
	CUSTOMSETTLEMENT=rsSelect.getString("CUSTOMSETTLEMENT");
	CLEANBONDUNIT=rsSelect.getString("CLEANBONDUNIT");
	}

	public boolean doAdd() throws SQLException
	{
		DbConnection dbc=new DbConnection();
		ResultSet rsCount;
		int nRowCount;
		String sqlAdd="INSERT INTO QYDJ_ZXXX_SQ(OPENO,PRIPID,CANDOCNO,CANREA,EXTCLEBRSIGN,CANCELBRSIGN,DECLECOMP,DECLEBRSIGN,AFFWRITNO,PUBNEWSNAME,PUBDATE,CANDATE,SANAUTH,SANDOCNO,SANDATE,BLICREVORINUM,BLICREVORINO,BLICREVDUPCONUM,BLICREVDUPCONO,CAREVNUM,CAREVST,BRANCHCANCON,DECLECON,REMARK,CLEANTAX,CANCELLATIONCERTIFICATE,CUSTOMSETTLEMENT,CLEANBONDUNIT) VALUES("+ doPreProcess3(OPENO)+","+ doPreProcess3(PRIPID)+","+ doPreProcess3(CANDOCNO)+","+ doPreProcess3(CANREA)+","+ doPreProcess3(EXTCLEBRSIGN)+","+ doPreProcess3(CANCELBRSIGN)+","+ doPreProcess3(DECLECOMP)+","+ doPreProcess3(DECLEBRSIGN)+","+ doPreProcess3(AFFWRITNO)+","+ doPreProcess3(PUBNEWSNAME)+",to_date("+doPreProcess3(PUBDATE)+",'yyyy-mm-dd'),to_date("+doPreProcess3(CANDATE)+",'yyyy-mm-dd'),"+ doPreProcess3(SANAUTH)+","+ doPreProcess3(SANDOCNO)+",to_date("+doPreProcess3(SANDATE)+",'yyyy-mm-dd'),"+BLICREVORINUM+","+ doPreProcess3(BLICREVORINO)+","+BLICREVDUPCONUM+","+ doPreProcess3(BLICREVDUPCONO)+","+CAREVNUM+","+ doPreProcess3(CAREVST)+","+ doPreProcess3(BRANCHCANCON)+","+ doPreProcess3(DECLECON)+","+ doPreProcess3(REMARK)+","+ doPreProcess3(CLEANTAX)+","+ doPreProcess3(CANCELLATIONCERTIFICATE)+","+ doPreProcess3(CUSTOMSETTLEMENT)+","+ doPreProcess3(CLEANBONDUNIT)+")";
		{							
			nRowCount=dbc.executeUpdate( sqlAdd );
			dbc.close();
			if (nRowCount>0)	//插入成功
				return true;
			else
				return false;
		}
	}

	public boolean doCount() throws SQLException
	{
		DbConnection dbc=new DbConnection();
		ResultSet rsCount;
		int nRowCount;
		String sqlCount="SELECT COUNT(*) FROM QYDJ_ZXXX_SQ"+" WHERE OPENO='"+doPreProcess(OPENO)+"'";
		rsCount=dbc.executeQuery( sqlCount );
		rsCount.next();
		nRowCount=rsCount.getInt( 1 );

		dbc.close();
		if (nRowCount>0)
		{
			return true;
		}
		else
			return false;
	}

	public boolean doModify() throws SQLException
	{
		DbConnection dbc=new DbConnection();
		String sqlModify="UPDATE QYDJ_ZXXX_SQ SET OPENO="+ doPreProcess3(OPENO)+",PRIPID="+ doPreProcess3(PRIPID)+",CANDOCNO="+ doPreProcess3(CANDOCNO)+",CANREA="+ doPreProcess3(CANREA)+",EXTCLEBRSIGN="+ doPreProcess3(EXTCLEBRSIGN)+",CANCELBRSIGN="+ doPreProcess3(CANCELBRSIGN)+",DECLECOMP="+ doPreProcess3(DECLECOMP)+",DECLEBRSIGN="+ doPreProcess3(DECLEBRSIGN)+",AFFWRITNO="+ doPreProcess3(AFFWRITNO)+",PUBNEWSNAME="+ doPreProcess3(PUBNEWSNAME)+",PUBDATE=to_date("+doPreProcess3(PUBDATE)+",'yyyy-mm-dd'),CANDATE=to_date("+doPreProcess3(CANDATE)+",'yyyy-mm-dd'),SANAUTH="+ doPreProcess3(SANAUTH)+",SANDOCNO="+ doPreProcess3(SANDOCNO)+",SANDATE=to_date("+doPreProcess3(SANDATE)+",'yyyy-mm-dd'),BLICREVORINUM="+BLICREVORINUM+",BLICREVORINO="+ doPreProcess3(BLICREVORINO)+",BLICREVDUPCONUM="+BLICREVDUPCONUM+",BLICREVDUPCONO="+ doPreProcess3(BLICREVDUPCONO)+",CAREVNUM="+CAREVNUM+",CAREVST="+ doPreProcess3(CAREVST)+",BRANCHCANCON="+ doPreProcess3(BRANCHCANCON)+",DECLECON="+ doPreProcess3(DECLECON)+",REMARK="+ doPreProcess3(REMARK)+",CLEANTAX="+doPreProcess3(CLEANTAX)+",CANCELLATIONCERTIFICATE="+doPreProcess3(CANCELLATIONCERTIFICATE)+",CUSTOMSETTLEMENT="+doPreProcess3(CUSTOMSETTLEMENT)+",CLEANBONDUNIT="+doPreProcess3(CLEANBONDUNIT)+""+" WHERE OPENO='"+doPreProcess(OPENO)+"'";
		int nRowCount=dbc.executeUpdate( sqlModify );
		dbc.close();
		if (nRowCount>0)	//修改成功
		{
			return true;
		}
		else
			return false;
	}

	public boolean doDelete() throws SQLException
	{
		DbConnection dbc=new DbConnection();
		String sqlDelete="DELETE FROM QYDJ_ZXXX_SQ"+" WHERE OPENO='"+doPreProcess(OPENO)+"'";
		int nRowCount=dbc.executeUpdate( sqlDelete );
		dbc.close();
		if (nRowCount>0)
		{
			return true;
		}
		else
			return false;
	}

	public int getListCount(String sqlWhere ) throws SQLException
	{
		DbConnection dbc=new DbConnection();
		String sqlCount="SELECT COUNT(*) FROM QYDJ_ZXXX_SQ";
		if (sqlWhere!=null&&sqlWhere.trim().compareTo("")!=0){
			if (sqlWhere.trim().toUpperCase().startsWith("WHERE")){
				sqlCount+=sqlWhere;}
			else {
				sqlCount+=" WHERE "+sqlWhere;}
		}
		ResultSet rsCount=dbc.executeQuery( sqlCount );
		rsCount.next();
		int nRowCount=rsCount.getInt( 1 );
		dbc.close();
		return nRowCount;

	}

	public ArrayList getList( String sqlWhere ) throws SQLException
	{
		DbConnection dbc=new DbConnection();
		ArrayList al= new ArrayList();
		String sqlList="SELECT * FROM QYDJ_ZXXX_SQ";
		if (sqlWhere!=null&&sqlWhere.trim().compareTo("")!=0){
			if (sqlWhere.trim().toUpperCase().startsWith("WHERE")){
				sqlList+=sqlWhere;}
			else {
				sqlList+=" WHERE "+sqlWhere;}
		}
		ResultSet rsList=dbc.executeQuery( sqlList );
		while(rsList.next()) {
			QYDJ_ZXXX_SQ bTable=new QYDJ_ZXXX_SQ();
			bTable.doSetData( rsList );
			al.add(bTable);
		}
		rsList.close();dbc.close();
		return al;

	}

	public Iterator getItList( String sqlWhere,String startRow ) throws SQLException
	{
		if (SysUtility.isNumeric(startRow))		
			return getList(sqlWhere,Integer.parseInt(startRow)).iterator();
		else		
			return getList(sqlWhere,0).iterator();
	}
	public ArrayList getList( String sqlWhere,String startRow ) throws SQLException
	{
		if (SysUtility.isNumeric(startRow))		
			return getList( sqlWhere,Integer.parseInt(startRow),10);
		else		
			return getList( sqlWhere,0,10);
	}
	public ArrayList getList( String sqlWhere,String startRow,int PageSize ) throws SQLException
	{
		if (SysUtility.isNumeric(startRow))		
			return getList( sqlWhere,Integer.parseInt(startRow),PageSize);
		else		
			return getList( sqlWhere,0,PageSize);
	}
	public ArrayList getList( String sqlWhere,int startRow ) throws SQLException
	{
			return getList( sqlWhere,startRow,10);
	}
	////////reload function getlist
	public ArrayList getList( String sqlWhere,int startRow,int PageSize) throws SQLException
	{
		DbConnection dbc=new DbConnection();
		ArrayList al= new ArrayList();
		String sqlList="SELECT * FROM QYDJ_ZXXX_SQ";
		if (sqlWhere!=null&&sqlWhere.trim().compareTo("")!=0){
			if (sqlWhere.trim().toUpperCase().startsWith("WHERE")){
				sqlList+=sqlWhere;}
			else {
				sqlList+=" WHERE "+sqlWhere;}
		}
		sqlList+=" AND ROWNUM<="+(startRow+PageSize);//start+pagesize 
		ResultSet rsList=dbc.executeQuery( sqlList);
		//过掉所有已经显示的列
		int	nDispRows=0;
		do
		{
			nDispRows++;
			if (nDispRows>startRow)	break;
		}
		while (rsList.next());
		while(rsList.next()) {
			QYDJ_ZXXX_SQ bTable=new QYDJ_ZXXX_SQ();
			bTable.doSetData( rsList );
			al.add(bTable);
		}
		rsList.close();dbc.close();
		return al;

	}

	public ArrayList getData() throws SQLException
	{
		DbConnection dbc=new DbConnection();
		String sqlArr="SELECT * FROM QYDJ_ZXXX_SQ"+" WHERE OPENO='"+doPreProcess(OPENO)+"'";
		ResultSet rsArr=dbc.executeQuery(sqlArr);
		ArrayList al= new ArrayList();
		String[] ay = null;
		if (rsArr.next()){	
			doSetData( rsArr );
			ResultSetMetaData rsmd = rsArr.getMetaData();
			for (int k=1;k<=rsmd.getColumnCount(); k++)	{
				ay = new String[2];
				ay[0]=rsmd.getColumnName(k);
				if (rsmd.getColumnTypeName(k).equalsIgnoreCase("DATETIME")||rsmd.getColumnTypeName(k).equalsIgnoreCase("DATE"))
					ay[1]=String.valueOf(rsArr.getDate(ay[0]));
				else
					ay[1]=String.valueOf(rsArr.getObject(ay[0]));
				if (!ay[1].trim().equals("null")&&!ay[1].trim().equals(""))
					{ay[1]=SysUtility.pre(ay[1]); al.add(ay);}
			}
		}
		dbc.close();
		return al;

	}
}
